<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Getting Started: Handing Form Submission</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="css/main.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</head>
<body>
    <form id="test" >
        <div class="form-group">
            <label for="name">Name</label>
            <input class="form-control" type="text" name="name" id="name" />
        </div>
        <div class="form-group">
            <label for="name">Phone number</label>
            <input class="form-control" type="text" name="phoneNumber" id="phoneNumber" />
        </div>
        <p>
            <input type="submit" value="Send" class="btn btn-primary btn-block" />
        </p>
    </form>
    <pre id="output"></pre>
    <script type="text/javascript">
        (function() {
            function toJSONString( form ) {
                var obj = {};
                var elements = form.querySelectorAll( "input, select, textarea" );
                for( var i = 0; i < elements.length; ++i ) {
                    var element = elements[i];
                    var name = element.name;
                    var value = element.value;

                    if( name ) {
                        obj[ name ] = value;
                    }
                }
                console.log(obj);
                return JSON.stringify( obj );
            }

            document.addEventListener( "DOMContentLoaded", function() {
                var form = document.getElementById( "test" );
                var output = document.getElementById( "output" );
                form.addEventListener( "submit", function( e ) {
                    e.preventDefault();
                    var json = toJSONString( this );
                    output.innerHTML = json;
                    console.log(json);
                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', 'http://localhost:8081/api/v1/users', true);
                    xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');
                    xhr.setRequestHeader('Accept', 'application/json -d');
                    xhr.send(json);
                }, false);

            });
        })();
    </script>
</body>
</html>